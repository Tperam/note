# 服务注册中心



#### 简单概念

服务注册中心，需要考虑多重因素

- 服务的上线
  - 上线后，我们需要让其他需要调用它的服务发现他。
- 服务的下线
  - 下线分为多种
    - 更新时导致的下线
    - 服务器挂了导致的下线
- 服务的迭代
  - 服务更新。

#### 简单流程

流程如下：

1. 当服务上线时，去服务中心注册（把server的ip port 发送过去）
2. 服务注册中心一直对 server 进行ping （保活）
3. 当client来了后，去访问服务注册中心，获取到 server 的 socket（ip port）
4. client 与 server 直接建立连接。
5. 开始服务调用以及通信



#### 坑

在这期间，有一些坑我们需要掌握。

1. server 与服务注册中心的网线断了，被剪掉了。但该 server 还能正常与 client 沟通。我服务注册中心通知到 client ， 某 server 去世了。client 需要如何响应？直接断开还是继续保持连接呢？
2. 当服务迭代时，我们以什么方式推送数据。





#### 可阅读源码

| 名称                                                        | 类型 | 描述        |
| ----------------------------------------------------------- | ---- | ----------- |
| [bilibili discovery](https://github.com/bilibili/discovery) | AP   | 仿照 Eureka |
| consul                                                      | CP   |             |
|                                                             |      |             |

